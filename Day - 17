𝐃𝐚𝐲 𝟏𝟕 𝐨𝐟 𝐭𝐡𝐞 𝐈𝐃𝐂 𝟐𝟏 𝐃𝐚𝐲𝐬 𝐨𝐟 𝐒𝐐𝐋 𝐂𝐡𝐚𝐥𝐥𝐞𝐧𝐠𝐞 sponsored by DPDzero started with the basics.


𝐐𝐮𝐞𝐬𝐭𝐢𝐨𝐧: 𝐂𝐑𝐄𝐀𝐓𝐄 𝐚 𝐑𝐄𝐏𝐎𝐑𝐓 𝐒𝐡𝐨𝐰𝐢𝐧𝐠 𝐄𝐚𝐜𝐡 𝐒𝐞𝐫𝐯𝐢𝐜𝐞 𝐖𝐢𝐭𝐡: 𝐒𝐄𝐑𝐕𝐈𝐂𝐄 𝐍𝐀𝐌𝐄, 𝐓𝐎𝐓𝐀𝐋 𝐏𝐀𝐓𝐈𝐄𝐍𝐓𝐒 𝐀𝐃𝐌𝐈𝐓𝐓𝐄𝐃, 𝐚𝐧𝐝 𝐓𝐡𝐞 𝐃𝐢𝐟𝐟𝐞𝐫𝐞𝐧𝐜𝐞 𝐁𝐞𝐭𝐰𝐞𝐞𝐧 𝐓𝐡𝐞𝐢𝐫 𝐓𝐎𝐓𝐀𝐋 𝐀𝐃𝐌𝐈𝐒𝐒𝐈𝐎𝐍𝐒 𝐀𝐧𝐝 𝐓𝐡𝐞 𝐀𝐕𝐄𝐑𝐀𝐆𝐄 𝐀𝐃𝐌𝐈𝐒𝐒𝐈𝐎𝐍𝐒 𝐀𝐜𝐫𝐨𝐬𝐬 𝐀𝐥𝐥 𝐒𝐞𝐫𝐯𝐢𝐜𝐞𝐬, 𝐀𝐧𝐝 𝐚 𝐑𝐀𝐍𝐊 𝐈𝐍𝐃𝐈𝐂𝐀𝐓𝐎𝐑 ('𝐀𝐛𝐨𝐯𝐞 𝐀𝐯𝐞𝐫𝐚𝐠𝐞', '𝐀𝐯𝐞𝐫𝐚𝐠𝐞', '𝐁𝐞𝐥𝐨𝐰 𝐀𝐯𝐞𝐫𝐚𝐠𝐞').  𝐎𝐑𝐃𝐄𝐑 𝐁𝐘 𝐓𝐨𝐭𝐚𝐥 𝐏𝐚𝐭𝐢𝐞𝐧𝐭𝐬 𝐀𝐝𝐦𝐢𝐭𝐭𝐞𝐝 𝐃𝐄𝐒𝐂𝐄𝐍𝐃𝐈𝐍𝐆.

-- 𝐅𝐄𝐓𝐂𝐇 𝐒𝐞𝐫𝐯𝐢𝐜𝐞𝐬_𝐖𝐞𝐞𝐤𝐥𝐲 𝐓𝐚𝐛𝐥𝐞.
𝐒𝐄𝐋𝐄𝐂𝐓 * 𝐅𝐑𝐎𝐌 Services_Weekly;

-- 𝐒𝐎𝐋𝐔𝐓𝐈𝐎𝐍.
𝐒𝐄𝐋𝐄𝐂𝐓
    𝐒𝐖.𝐒𝐄𝐑𝐕𝐈𝐂𝐄 𝐀𝐒 Service_Name,
    𝐒𝐔𝐌(𝐒𝐖.𝐏𝐚𝐭𝐢𝐞𝐧𝐭𝐬_𝐀𝐝𝐦𝐢𝐭𝐭𝐞𝐝) 𝐀𝐒 Total_Admissions,
    𝐒𝐔𝐌(𝐒𝐖.𝐏𝐚𝐭𝐢𝐞𝐧𝐭𝐬_𝐀𝐝𝐦𝐢𝐭𝐭𝐞𝐝) - 𝐀𝐕𝐆_𝐓𝐀𝐁𝐋𝐄.𝐀𝐕𝐆_𝐀𝐃𝐌𝐈𝐒𝐒𝐈𝐎𝐍𝐒 𝐀𝐒 DIFF_FROM_AVG,
    𝐂𝐀𝐒𝐄
        𝐖𝐇𝐄𝐍 𝐒𝐔𝐌(𝐒𝐖.𝐏𝐚𝐭𝐢𝐞𝐧𝐭𝐬_𝐀𝐝𝐦𝐢𝐭𝐭𝐞𝐝) > 𝐀𝐕𝐆_𝐓𝐀𝐁𝐋𝐄.𝐀𝐕𝐆_𝐀𝐃𝐌𝐈𝐒𝐒𝐈𝐎𝐍𝐒 THEN '𝐀𝐛𝐨𝐯𝐞 𝐀𝐯𝐞𝐫𝐚𝐠𝐞'
        𝐖𝐇𝐄𝐍 𝐒𝐔𝐌(𝐒𝐖.𝐏𝐚𝐭𝐢𝐞𝐧𝐭𝐬_𝐀𝐝𝐦𝐢𝐭𝐭𝐞𝐝) < 𝐀𝐕𝐆_𝐓𝐀𝐁𝐋𝐄.𝐀𝐕𝐆_𝐀𝐃𝐌𝐈𝐒𝐒𝐈𝐎𝐍𝐒 THEN '𝐁𝐞𝐥𝐨𝐰 𝐀𝐯𝐞𝐫𝐚𝐠𝐞'
        𝐄𝐋𝐒𝐄 '𝐀𝐯𝐞𝐫𝐚𝐠𝐞'
    𝐄𝐍𝐃 𝐀𝐒 RANK_INDICATOR
𝐅𝐑𝐎𝐌 Services_Weekly SW
𝐉𝐎𝐈𝐍 (
    𝐒𝐄𝐋𝐄𝐂𝐓 𝐑𝐎𝐔𝐍𝐃(𝐀𝐕𝐆(𝐓𝐨𝐭𝐚𝐥_𝐀𝐝𝐦𝐢𝐬𝐬𝐢𝐨𝐧𝐬), 𝟐) 𝐀𝐒 AVG_ADMISSIONS
    𝐅𝐑𝐎𝐌 (
        𝐒𝐄𝐋𝐄𝐂𝐓 𝐒𝐄𝐑𝐕𝐈𝐂𝐄, 𝐒𝐔𝐌(𝐏𝐚𝐭𝐢𝐞𝐧𝐭𝐬_𝐀𝐝𝐦𝐢𝐭𝐭𝐞𝐝) 𝐀𝐒 Total_Admissions
        𝐅𝐑𝐎𝐌 Services_Weekly
        𝐆𝐑𝐎𝐔𝐏 𝐁𝐘 SERVICE
    ) SUB
) AVG_TABLE
𝐆𝐑𝐎𝐔𝐏 𝐁𝐘 SW.SERVICE, AVG_TABLE.AVG_ADMISSIONS
𝐎𝐑𝐃𝐄𝐑 𝐁𝐘 Total_Admissions 𝐃𝐄𝐒𝐂;
